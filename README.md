# DE_T4.4.2
Задание 4.4.2
Двигаемся дальше, и теперь на очереди — Hive!

Первым делом нужно достать данные — заходим и грузим все, что есть из репозитория: [GitHub - sultanmurad/csv_files.](https://github.com/sultanmurad/csv_files)

Эти файлы будут подвержены анализу, но в них кое-чего не достает — добавьте в каждый файл столбец с номером группы таким образом, чтобы файл был разделен на 10 групп. В файл customers.csv добавьте столбец с номером года, в который была совершена подписка (Subscription Date). Используйте средства python + pandas.

Загрузите полученные файлы на hdfs. 

Теперь ваша задача следующая: аналитики хотят сводную статистику на уровне каждой компании и на уровне каждого года получить целевую возрастную группу подписчиков — то есть, возрастную группу, представители которой чаще всего совершали подписку именно в текущий год на текущую компанию. 

Например:

![Image alt](https://github.com/MOMIV/DE_T4.4.2/raw/main/pic/01.png)


Все операции необходимо выполнить в Hive. Работать с Hive можно через интерфейс HUE, если перейти в раздел «Query», или выбрав нужный пункт в разделе «Editor».

Таким образом вам нужно создать под каждый csv-файл отдельную таблицу. Для оптимизации используйте свои знания партиционирования и бакетирования. А затем на основе 3-х таблиц собрать витрину, которая решает поставленную задачу. В качестве результата предоставьте код SQL-запросов для создания исходных таблиц и создания итоговой витрины.

В качестве результата необходимо предоставить:

скрипты на python+pandas для предобработки исходных файлов

код загрузки файлов на hdfs

код всех запросов для создания таблиц и план запроса для формирования витрины.


Решение

1. [Предобработка исходных данных](https://github.com/MOMIV/DE_T4.4.2/blob/main/T4.4.2.ipynb)

2. Загрузка файлов на hdfs

![Image alt](https://github.com/MOMIV/DE_T4.4.2/raw/main/pic/1.png)

![Image alt](https://github.com/MOMIV/DE_T4.4.2/raw/main/pic/2.png)

![Image alt](https://github.com/MOMIV/DE_T4.4.2/raw/main/pic/3.png)

 

